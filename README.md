# Инструкция по использованию

## Разработчики
- Горкин Всеволод - 23.М11-ПУ
- Степанов Владислав - 23.М11-ПУ

## Описание
Данный проект представляет собой веб-приложение на Streamlit для анализа интонации речи в аудио- и видеозаписях. 
Он использует модель Wav2Vec2 для классификации эмоций на основе записанной или загруженной речи.

## Требования
Перед началом работы убедитесь, что у вас установлены следующие зависимости:

- Python 3.8+
- CUDA 12.1 (если используется GPU)
- PyTorch (совместимый с вашей версией CUDA)
- Streamlit
- NumPy
- Librosa
- SoundDevice
- Pandas
- ffmpeg
- webrtcvad
- Matplotlib
- moviepy
- Transformers (Hugging Face)
- TorchAudio

### Установка зависимостей

```sh
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
pip install streamlit numpy librosa sounddevice pandas ffmpeg-python webrtcvad matplotlib moviepy transformers torchaudio
```

## Запуск приложения

1. Скачайте и сохраните модель Wav2Vec2 в файл `model.pth`.
2. Запустите приложение командой:

```sh
streamlit run app.py
```

## Функциональность

Приложение позволяет:

- Записывать аудио с микрофона и классифицировать эмоции
- Загружать видеофайлы, извлекать из них аудиодорожку и анализировать эмоциональную окраску речи
- Визуализировать временную шкалу с отмеченными интервалами речи и соответствующими эмоциями

## Использование

1. Откройте веб-интерфейс приложения в браузере.
2. Выберите режим работы:
   - "Запись аудио" – записывает ваш голос и анализирует эмоции.
   - "Загрузка видео" – анализирует эмоции в речи из загруженного видеофайла.
3. Дождитесь обработки и просмотрите результаты в виде таблицы и графика временной шкалы.

## Примечания

- VAD (Voice Activity Detection) используется для разбиения аудиофайлов на участки речи.
- Режим VAD можно настроить (0 – мягкий, 3 – строгий).
- Доступные классы эмоций: нейтральный, радостный, грустный, злой, испуганный, отвращение, удивленный.
- TorchAudio используется для работы с аудиофайлами в разных форматах.

